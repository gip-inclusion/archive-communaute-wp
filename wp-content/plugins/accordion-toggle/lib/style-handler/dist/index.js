!function(){"use strict";var t=window.wp.data,e=window.lodash,n=window.wp.blocks;function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,a=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}!function(){var i=eb_style_handler.editor_type,a=function(t,e){return t&&e?t+"//"+e:null},c=function(){},s=function(){},l={};"edit-site"===i?l=(0,t.select)("core/edit-site"):"edit-post"===i&&(l=(0,t.select)("core/edit-post")),s=l.__experimentalGetPreviewDeviceType,window.ebEditCurrentPreviewOption=s();var u=(0,t.select)("core/editor"),d=u.isSavingPost,f=void 0===d?c:d,v=u.isAutosavingPost,b=void 0===v?c:v,p=u.isSavingNonPostEntityChanges,y=void 0===p?c:p,m=/^essential\-blocks\//g,h=function(){var r=(0,t.select)("core").getEditedEntityRecord,s=void 0===r?c:r,l=(0,t.select)("core/block-editor").getBlocks,u=void 0===l?c:l,d=(0,t.select)("core/editor").getCurrentPostId,f=(void 0===d?c:d)(),v=u(),b={};!function t(r){var i,c=o(r);try{for(c.s();!(i=c.n()).done;){var l=i.value,u=l.attributes,d=u.blockMeta,f=u.blockRoot,v=u.blockId,p=l.innerBlocks;if((0,e.isFunction)(n.isReusableBlock)&&(0,n.isReusableBlock)(l)){var y,m=s("postType","wp_block",l.attributes.ref)||{},h=o(m.content?(0,n.parse)((0,e.isFunction)(m.content)?m.content(m):m.content):[]);try{for(h.s();!(y=h.n()).done;){var w=y.value,g=w.attributes,k=g.blockMeta,S=g.blockRoot,_=g.blockId,A=w.innerBlocks;k&&"essential_block"===S&&(b[_]=k),A.length>0&&t(A)}}catch(t){h.e(t)}finally{h.f()}}else if((0,e.isFunction)(n.isTemplatePart)&&(0,n.isTemplatePart)(l)){var E=l.attributes,O=E.theme,T=E.slug,P=s("postType","wp_template_part",a(O,T))||{},j=P.blocks,B=void 0===j?[]:j,I=P.innerBlocks,C=void 0===I?[]:I;t(B),t(C)}else d&&"essential_block"===f&&(b[v]=d);p.length>0&&t(p)}}catch(t){c.e(t)}finally{c.f()}}(v);var p=JSON.stringify(b);jQuery.ajax({type:"POST",url:ajaxurl,data:{data:p,id:f,editorType:i,action:"eb_write_block_css",nonce:eb_style_handler.sth_nonce},error:function(t){console.log(t)}})},w=function(){if(window.ebEditCurrentPreviewOption!==s()){var e=s();window.ebEditCurrentPreviewOption=e,function(t){var e=t.resOption,n=t.domObj.querySelectorAll(".eb-guten-block-main-parent-wrapper > style");if(n.length<1)return!1;var o,i=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){s=!0,a=t},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw a}}}}(n);try{for(i.s();!(o=i.n()).done;){var a=o.value,c=a.textContent.replace(/\s+/g," "),s=/(mimmikcssStart\s\*\/)(.+)(\/\*\smimmikcssEnd)/i,l=" ";if("Tablet"===e){var u=(c.match(/tabcssStart\s\*\/(.+)(?=\/\*\stabcssEnd)/i)||[," "])[1];l=c.replace(s,"$1 ".concat(u," $3"))}else if("Mobile"===e){var d=(c.match(/tabcssStart\s\*\/(.+)(?=\/\*\stabcssEnd)/i)||[," "])[1],f=(c.match(/mobcssStart\s\*\/(.+)(?=\/\*\smobcssEnd)/i)||[," "])[1];l=c.replace(s,"$1 ".concat(d," ").concat(f," $3"))}else l=c.replace(s,"$1  $3");a.textContent=l}}catch(t){i.e(t)}finally{i.f()}}({domObj:document,resOption:e});var n=lodash.isFunction,i=wp.blocks,l=i.parse,u=void 0===l?c:l,d=i.isReusableBlock,f=void 0===d?c:d,v=i.isTemplatePart,b=void 0===v?c:v,p=(0,t.select)("core").getEditedEntityRecord,y=void 0===p?c:p,h=(0,t.select)("core/block-editor"),w=h.getBlocks,g=void 0===w?c:w,k=h.updateBlockAttributes,S=void 0===k?c:k;!function t(r){var i,c=o(r);try{for(c.s();!(i=c.n()).done;){var s=i.value,l=s.name,d=void 0===l?"":l,v=s.clientId,p=s.innerBlocks,h=void 0===p?[]:p;if(n(f)&&f(s)){var w=y("postType","wp_block",s.attributes.ref)||{};t(w.content?u(n(w.content)?w.content(w):w.content):[])}else if(n(b)&&b(s)){var g=s.attributes,k=g.theme,_=g.slug,A=y("postType","wp_template_part",a(k,_))||{},E=A.blocks,O=void 0===E?[]:E,T=A.innerBlocks,P=void 0===T?[]:T;t(O),t(P)}else m.test(d)&&S(v,{resOption:e});h.length>0&&t(h)}}catch(t){c.e(t)}finally{c.f()}}(g())}};"edit-site"===i?(0,t.subscribe)((function(){y()&&h(),w()})):"edit-post"===i&&(0,t.subscribe)((function(){f()&&!b()&&h(),w()}))}()}();